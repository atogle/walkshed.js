function MinHeap(e,t){this.heap=e||new Array,this.compare=t||function(e,t){return e==t?0:e<t?-1:1},this.left=function(e){return 2*e+1},this.right=function(e){return 2*e+2},this.parent=function(e){return Math.ceil(e/2)-1},this.heapify=function(e){var t=this.left(e),n=this.right(e),r;t<this.heap.length&&this.compare(this.heap[t],this.heap[e])<0?r=t:r=e,n<this.heap.length&&this.compare(this.heap[n],this.heap[r])<0&&(r=n);if(e!=r){var i=this.heap[r];this.heap[r]=this.heap[e],this.heap[e]=i,this.heapify(r)}},this.siftUp=function(e){var t=this.parent(e);if(t>=0&&this.compare(this.heap[t],this.heap[e])>0){var n=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=n,this.siftUp(t)}},this.heapifyArray=function(){var e=Math.floor(this.heap.length/2)-1;for(;e>=0;e--)this.heapify(e)},e!=null&&this.heapifyArray()}MinHeap.prototype.push=function(e){this.heap.push(e),this.siftUp(this.heap.length-1)},MinHeap.prototype.insert=function(e){this.push(e)},MinHeap.prototype.pop=function(){var e;return this.heap.length>1?(e=this.heap[0],this.heap[0]=this.heap.pop(),this.heapify(0)):e=this.heap.pop(),e},MinHeap.prototype.remove=function(){return this.pop()},MinHeap.prototype.getMin=function(){return this.heap[0]},MinHeap.prototype.size=function(){return this.heap.length};var costDistance=function(e){var t={},n=-1;return t._getCost=function(e,n,r,i,s){return e[n][r]===t.NODATA||e[i][s]===t.NODATA?NaN:n===i||r===s?(e[n][r]+e[i][s])/2:1.414214*(e[n][r]+e[i][s])/2},t.calculate=function(e,n,r){var i=e.length,s=e[0].length,o=[],u=new MinHeap(null,function(e,t){return e.cost===t.cost?0:e.cost<t.cost?-1:1}),a,f,l,c,h,p,d,v,m;for(l=0,h=e.length;l<h;l++)o[l]=[];for(l=0,h=n.length;l<h;l++)for(c=0,p=n[l].length;c<p;c++)n[l][c]>0&&(o[l][c]=0,u.push({row:l,col:c,cost:0}));while(u.size()){d=u.pop();if(!r||r&&d.cost<r){l=d.row,c=d.col;for(f=1;f<=8;f++){switch(f){case 1:c=d.col-1;break;case 2:c=d.col+1;break;case 3:l=d.row-1,c=d.col;break;case 4:l=d.row+1;break;case 5:l=d.row-1,c=d.col-1;break;case 6:c=d.col+1;break;case 7:l=d.row+1;break;case 8:c=d.col-1}if(l>=0&&l<i&&c>=0&&c<s){v=t._getCost(e,d.row,d.col,l,c);if(isNaN(v))o[l][c]=NaN;else{m=d.cost+v;if(o[l][c]===a||m<o[l][c])o[l][c]=m,u.push({row:l,col:c,cost:m})}}}}}return o},t};